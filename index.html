<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å¿ƒé‡‘é­‚é“¶å›¾é‰´æ ‡è®°</title>
    
    <!-- ç§»åŠ¨ç«¯åˆ˜æµ·å±é€‚é… -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#ffffff">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;600&display=swap');
        
        /* ç¡®ä¿åˆ˜æµ·åŒºåŸŸèƒŒæ™¯å®Œå…¨ä¸ºç™½è‰² */
        html { background-color: #ffffff; }
        body { 
            font-family: 'Noto Sans SC', sans-serif; 
            -webkit-text-size-adjust: 100%;
            margin: 0;
            background-color: #ffffff; 
        }
        
        .pokemon-card { 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .pokemon-thumb {
            transition: transform 0.4s ease, opacity 0.3s ease;
        }
        
        /* æ•æ‰çŠ¶æ€å¡ç‰‡çš„æ·¡çº¢è‰²è®¾è®¡æ„Ÿé˜´å½± */
        .captured-shadow {
            box-shadow: 0 10px 25px -5px rgba(239, 68, 68, 0.15), 0 8px 10px -6px rgba(239, 68, 68, 0.1);
        }

        .uncaptured-img { 
            opacity: 0.25; 
        }

        ::-webkit-scrollbar { width: 0px; background: transparent; }

        input { 
            -webkit-appearance: none;
        }

        header {
            padding-top: env(safe-area-inset-top);
        }

        .tab-segment {
            height: 44px;
            background-color: #f1f5f9;
            border-radius: 12px;
            padding: 4px;
            display: flex;
            align-items: stretch;
        }
    </style>
</head>
<body class="bg-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Icon = ({ name, className = "w-5 h-5" }) => {
            const icons = {
                pocket: <path d="M4 3h16a2 2 0 0 1 2 2v6a10 10 0 0 1-10 10A10 10 0 0 1 2 11V5a2 2 0 0 1 2-2z" />,
                search: <React.Fragment><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></React.Fragment>,
                check: <path d="M20 6 9 17l-5-5"/>,
                ghost: <React.Fragment><path d="M9 10h.01"/><path d="M15 10h.01"/><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"/></React.Fragment>
            };
            return (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        // åŸéƒ½å›¾é‰´å¯¹åº”å…³ç³»æ•°æ® (HGSS æ­£ç¡®æ˜ å°„)
        const JOHTO_DEX_MAP = {
            152:1, 153:2, 154:3, 155:4, 156:5, 157:6, 158:7, 159:8, 160:9, 
            16:10, 17:11, 18:12, 21:13, 22:14, 163:15, 164:16, 19:17, 20:18, 
            27:19, 28:20, 161:21, 162:22, 25:23, 26:24, 10:25, 11:26, 12:27, 
            13:28, 14:29, 15:30, 165:31, 166:32, 167:33, 168:34, 41:35, 42:36, 
            169:37, 74:38, 75:39, 76:40, 172:41, 173:44, 35:45, 36:46, 174:47, 
            39:48, 40:49, 175:50, 176:51, 468:52, 177:53, 178:54, 179:55, 180:56, 
            181:57, 182:58, 43:59, 44:60, 45:61, 69:63, 70:64, 71:65, 187:66, 
            188:67, 189:68, 190:69, 424:70, 60:71, 61:72, 62:73, 186:74, 79:75, 
            80:76, 199:77, 96:78, 97:79, 193:80, 469:81, 194:82, 195:83, 92:84, 
            93:85, 94:86, 95:87, 464:88, 201:89, 202:90, 63:91, 64:92, 65:93, 
            66:94, 67:95, 68:96, 122:97, 439:98, 204:99, 205:100, 206:101, 
            207:102, 472:103, 191:104, 192:105, 203:113, 127:114, 214:115, 54:116, 
            55:117, 118:118, 119:119, 129:120, 130:121, 116:122, 117:123, 230:124, 
            120:125, 121:126, 37:127, 38:128, 58:129, 59:130, 81:131, 82:132, 
            462:133, 100:134, 101:135, 125:136, 466:137, 126:138, 467:139, 124:140, 
            238:141, 123:142, 212:143, 114:146, 465:147, 83:148, 131:149, 132:150, 
            211:151, 170:152, 171:153, 222:154, 223:155, 224:156, 86:159, 87:160, 
            90:161, 91:162, 209:169, 210:170, 133:171, 134:172, 135:173, 136:174, 
            196:175, 197:176, 470:177, 471:178, 128:179, 241:180, 113:181, 242:182, 
            440:183, 231:186, 232:187, 216:188, 217:189, 215:190, 461:191, 220:192, 
            221:193, 473:194, 225:195, 226:196, 227:197, 228:198, 229:199, 147:202, 
            148:203, 149:204, 77:205, 78:206, 108:207, 463:208, 143:209, 446:210, 
            234:211, 235:212, 236:220, 106:221, 107:222, 237:223, 246:226, 247:227, 
            248:228, 243:229, 244:230, 245:231, 249:232, 250:233, 251:234, 150:255, 151:256
        };

        const ALL_NAMES = ["å¦™è›™ç§å­","å¦™è›™è‰","å¦™è›™èŠ±","å°ç«é¾™","ç«æé¾™","å–·ç«é¾™","æ°å°¼é¾Ÿ","å¡å’ªé¾Ÿ","æ°´ç®­é¾Ÿ","ç»¿æ¯›è™«","é“ç”²è›¹","å·´å¤§è¶","ç‹¬è§’è™«","é“å£³è›¹","å¤§é’ˆèœ‚","æ³¢æ³¢","æ¯”æ¯”é¸Ÿ","å¤§æ¯”é¸Ÿ","å°æ‹‰è¾¾","æ‹‰è¾¾","çƒˆé›€","å¤§å˜´é›€","é˜¿æŸè›‡","é˜¿æŸæ€ª","çš®å¡ä¸˜","é›·ä¸˜","ç©¿å±±é¼ ","ç©¿å±±ç‹","å°¼å¤šå…°","å°¼å¤šå¨œ","å°¼å¤šå","å°¼å¤šæœ—","å°¼å¤šåŠ›è¯º","å°¼å¤šç‹","çš®çš®","çš®å¯è¥¿","å…­å°¾","ä¹å°¾","èƒ–ä¸","èƒ–å¯ä¸","è¶…éŸ³è ","å¤§å˜´è ","èµ°è·¯è‰","è‡­è‡­èŠ±","éœ¸ç‹èŠ±","æ´¾æ‹‰æ–¯","æ´¾æ‹‰æ–¯ç‰¹","æ¯›çƒ","æ‘©é²è›¾","åœ°é¼ ","ä¸‰åœ°é¼ ","å–µå–µ","çŒ«è€å¤§","å¯è¾¾é¸­","å“¥è¾¾é¸­","çŒ´æ€ª","ç«æš´çŒ´","å¡è’‚ç‹—","é£é€Ÿç‹—","èšŠé¦™èŒèšª","èšŠé¦™å›","èšŠé¦™æ³³å£«","å‡¯è¥¿","å‹‡åŸºæ‹‰","èƒ¡åœ°","è…•åŠ›","è±ªåŠ›","æ€ªåŠ›","å–‡å­èŠ½","å£å‘†èŠ±","å¤§é£ŸèŠ±","ç›ç‘™æ°´æ¯","æ¯’åˆºæ°´æ¯","å°æ‹³çŸ³","éš†éš†çŸ³","éš†éš†å²©","å°ç«é©¬","çƒˆç„°é©¬","å‘†å‘†å…½","å‘†å£³å…½","å°ç£æ€ª","ä¸‰åˆä¸€ç£æ€ª","å¤§è‘±é¸­","å˜Ÿå˜Ÿ","å˜Ÿå˜Ÿåˆ©","å°æµ·ç‹®","ç™½æµ·ç‹®","è‡­æ³¥","è‡­è‡­æ³¥","å¤§èˆŒè´","åˆºç”²è´","é¬¼æ–¯","é¬¼æ–¯é€š","è€¿é¬¼","å¤§å²©è›‡","ç´ åˆ©æ™®","ç´ åˆ©æ‹","å¤§é’³èŸ¹","å·¨é’³èŸ¹","é›·ç”µçƒ","é¡½çš®é›·å¼¹","è›‹è›‹","æ¤°è›‹æ ‘","å¡æ‹‰å¡æ‹‰","å˜å•¦å˜å•¦","é£è…¿éƒ","å¿«æ‹³éƒ","å¤§èˆŒå¤´","ç“¦æ–¯å¼¹","åŒå¼¹ç“¦æ–¯","ç‹¬è§’çŠ€ç‰›","é’»è§’çŠ€å…½","å‰åˆ©è›‹","è—¤è”“æ€ª","è¢‹å…½","å¢¨æµ·é©¬","æµ·åˆºé¾™","è§’é‡‘é±¼","é‡‘é±¼ç‹","æµ·æ˜Ÿæ˜Ÿ","å®çŸ³æµ·æ˜Ÿ","é­”å¢™äººå¶","é£å¤©è³è‚","è¿·å”‡å§","ç”µå‡»å…½","é¸­å˜´ç«å…½","å‡¯ç½—æ–¯","è‚¯æ³°ç½—","é²¤é±¼ç‹","æš´é²¤é¾™","æ‹‰æ™®æ‹‰æ–¯","ç™¾å˜æ€ª","ä¼Šå¸ƒ","æ°´ä¼Šå¸ƒ","é›·ä¼Šå¸ƒ","ç«ä¼Šå¸ƒ","å¤šè¾¹å…½","èŠçŸ³å…½","å¤šåˆºèŠçŸ³å…½","åŒ–çŸ³ç›”","é•°åˆ€ç›”","åŒ–çŸ³ç¿¼é¾™","å¡æ¯”å…½","æ€¥å†»é¸Ÿ","é—ªç”µé¸Ÿ","ç«ç„°é¸Ÿ","è¿·ä½ é¾™","å“ˆå…‹é¾™","å¿«é¾™","è¶…æ¢¦","æ¢¦å¹»","èŠè‰å¶","æœˆæ¡‚å¶","å¤§ç«ºè‘µ","ç«çƒé¼ ","ç«å²©é¼ ","ç«æš´å…½","å°é”¯é³„","è“é³„","å¤§åŠ›é³„","å°¾ç«‹","å¤§å°¾ç«‹","å’•å’•","çŒ«å¤´å¤œé¹°","èŠ­èŠ­è¶","å®‰çº³è¶","åœ†ä¸è››","é˜¿åˆ©å¤šæ–¯","å‰å­—è ","ç¯ç¬¼é±¼","ç”µç¯æ€ª","çš®ä¸˜","çš®å®å®","å®å®ä¸","æ³¢å…‹æ¯”","æ³¢å…‹åŸºå¤","å¤©ç„¶é›€","å¤©ç„¶é¸Ÿ","å’©åˆ©ç¾Š","èŒ¸èŒ¸ç¾Š","ç”µé¾™","ç¾ä¸½èŠ±","ç›åŠ›éœ²","ç›åŠ›éœ²ä¸½","èƒ¡è¯´æ ‘","èšŠé¦™è›™çš‡","æ¯½å­è‰","æ¯½å­èŠ±","æ¯½å­æ£‰","é•¿å°¾æ€ªæ‰‹","å‘æ—¥ç§å­","å‘æ—¥èŠ±æ€ª","èœ»èœ»èœ“","ä¹Œæ³¢","æ²¼ç‹","å¤ªé˜³ä¼Šå¸ƒ","æœˆäº®ä¼Šå¸ƒ","é»‘æš—é¸¦","å‘†å‘†ç‹","æ¢¦å¦–","æœªçŸ¥å›¾è…¾","æœç„¶ç¿","éº’éºŸå¥‡","æ¦›æœçƒ","ä½›çƒˆæ‰˜æ–¯","åœŸé¾™å¼Ÿå¼Ÿ","å¤©è","å¤§é’¢è›‡","å¸ƒé²","å¸ƒé²çš‡","åƒé’ˆé±¼","å·¨é’³è³è‚","å£¶å£¶","èµ«æ‹‰å…‹ç½—æ–¯","ç‹ƒæ‹‰","ç†Šå®å®","åœˆåœˆç†Š","ç†”å²©è™«","ç†”å²©èœ—ç‰›","å°å±±çŒª","é•¿æ¯›çŒª","å¤ªé˜³çŠç‘š","é“ç‚®é±¼","ç« é±¼æ¡¶","ä¿¡ä½¿é¸Ÿ","å·¨ç¿…é£é±¼","ç›”ç”²é¸Ÿ","æˆ´é²æ¯”","é»‘é²åŠ ","åˆºé¾™ç‹","å°å°è±¡","é¡¿ç”²","å¤šè¾¹å…½â…¡","æƒŠè§’é¹¿","å›¾å›¾çŠ¬","å·´å°”éƒ","æˆ˜èˆéƒ","è¿·å”‡å¨ƒ","ç”µå‡»æ€ª","å°é¸­å˜´é¾™","å¤§å¥¶ç½","å¹¸ç¦è›‹","é›·å…¬","ç‚å¸","æ°´å›","å¹¼åŸºæ‹‰æ–¯","æ²™åŸºæ‹‰æ–¯","ç­åŸºæ‹‰æ–¯","æ´›å¥‡äºš","å‡¤ç‹","é›ªæ‹‰æ¯”","æœ¨å®ˆå®«","æ£®æ—èœ¥èœ´","èœ¥èœ´ç‹","ç«ç¨šé¸¡","åŠ›å£®é¸¡","ç«ç„°é¸¡","æ°´è·ƒé±¼","æ²¼è·ƒé±¼","å·¨æ²¼æ€ª","åœŸç‹¼çŠ¬","å¤§ç‹¼çŠ¬","è›‡çº¹ç†Š","ç›´å†²ç†Š","åˆºå°¾è™«","ç”²å£³èŒ§","ç‹©çŒå‡¤è¶","ç›¾ç”²èŒ§","æ¯’ç²‰è›¾","è²å¶ç«¥å­","è²å¸½å°ç«¥","ä¹å¤©æ²³ç«¥","æ©¡å®æœ","é•¿é¼»å¶","ç‹¡çŒ¾å¤©ç‹—","å‚²éª¨ç‡•","å¤§ç‹ç‡•","é•¿ç¿…é¸¥","å¤§å˜´é¸¥","æ‹‰é²æ‹‰ä¸","å¥‡é²è‰å®‰","æ²™å¥ˆæœµ","æºœæºœç³–çƒ","é›¨ç¿…è›¾","è˜‘è˜‘è‡","æ–—ç¬ è‡","æ‡’äººç­","è¿‡åŠ¨çŒ¿","è¯·å‡ç‹","åœŸå±…å¿å£«","é“é¢å¿è€…","è„±å£³å¿è€…","å’•å¦å¦","å¼çˆ†å¼¹","çˆ†éŸ³æ€ª","å¹•ä¸‹åŠ›å£«","è¶…åŠ›ç‹","éœ²åŠ›ä¸½","æœåŒ—é¼»","å‘å°¾å–µ","ä¼˜é›…çŒ«","å‹¾é­‚çœ¼","å¤§å˜´å¨ƒ","å¯å¯å¤šæ‹‰","å¯å¤šæ‹‰","æ³¢å£«å¯å¤šæ‹‰","ç›æ²™é‚£","æ°é›·å§†","è½é›·å…½","é›·ç”µå…½","æ­£ç”µæ‹æ‹","è´Ÿç”µæ‹æ‹","ç”µè¤è™«","ç”œç”œè¤","æ¯’è”·è–‡","æº¶é£Ÿå…½","åé£Ÿå…½","åˆ©ç‰™é±¼","å·¨ç‰™é²¨","å¼å¼é²¸","å¼é²¸ç‹","å‘†ç«é©¼","å–·ç«é©¼","ç…¤ç‚­é¾Ÿ","è·³è·³çŒª","å™—å™—çŒª","æ™ƒæ–‘","å¤§é¢šèš","è¶…éŸ³éŸ³æ³¢å¹¼è™«","æ²™æ¼ èœ»èœ“","æ²™æ¼ å¥ˆäºš","æ¢¦æ­Œä»™äººæŒ","é’ç»µé¸Ÿ","ä¸ƒå¤•é’é¸Ÿ","çŒ«é¼¬æ–©","é¥­åŒ™è›‡","æœˆçŸ³","å¤ªé˜³å²©","æ³¥æ³¥é³…","åœ°éœ‡é²¶é±¼","é¾™è™¾å°å…µ","é“è¯é¾™è™¾","å¤©ç§¤å¶","å¿µåŠ›åœŸå¶","è§¦æ‰‹ç™¾åˆ","æ‘‡ç¯®ç™¾åˆ","å¤ªå¤ç¾½è™«","å¤ªå¤ç›”ç”²","å¤§é»„é±¼","ç¾çº³æ–¯","é£˜æµ®æ³¡æ³¡","å˜éšé¾™","æ€¨å½±å¨ƒå¨ƒ","è¯…å’’å¨ƒå¨ƒ","å¤œå·¡çµ","å¤œå·¨äºº","çƒ­å¸¦é¾™","é£é“ƒé“ƒ","é˜¿å‹ƒæ¢­é²","å°æœç„¶","é›ªç«¥å­","å†°é¬¼æŠ¤","æµ·è±¹çƒ","æµ·é­”ç‹®","å¸ç‰™æµ·ç‹®","çç è´","çŒæ–‘é±¼","æ¨±èŠ±é±¼","å¤ç©ºæ£˜é±¼","çˆ±å¿ƒé±¼","å®è´é¾™","ç”²å£³é¾™","æš´é£é¾™","é“å“‘é“ƒ","é‡‘å±æ€ª","å·¨é‡‘æ€ª","é›·å‰æ´›å…‹","é›·å‰è‰¾æ–¯","é›·å‰æ–¯å¥‡é²","æ‹‰å¸äºšæ–¯","æ‹‰å¸æ¬§æ–¯","ç›–æ¬§å¡","å›ºæ‹‰å¤š","çƒˆç©ºå","åŸºæ‹‰ç¥ˆ","ä»£æ¬§å¥‡å¸Œæ–¯","è‰è‹—é¾Ÿ","æ ‘æ—é¾Ÿ","åœŸå°é¾Ÿ","å°ç«ç„°çŒ´","çŒ›ç«çŒ´","çƒˆç„°çŒ´","æ³¢åŠ æ›¼","æ³¢çš‡å­","å¸ç‹æ‹¿æ³¢","å§†å…‹å„¿","å§†å…‹é¸Ÿ","å§†å…‹é¹°","å¤§ç‰™ç‹¸","å¤§å°¾ç‹¸","åœ†æ³•å¸ˆ","éŸ³ç®±èŸ€","å°çŒ«æ€ª","å‹’å…‹çŒ«","ä¼¦ç´çŒ«","å«ç¾è‹","ç½—ä¸é›·æœµ","å¤´ç›–é¾™","æˆ˜æ§Œé¾™","ç›¾ç”²é¾™","æŠ¤åŸé¾™","ç»“è‰å„¿","ç»“è‰è´µå¦‡","ç»…å£«è›¾","ä¸‰èœœèœ‚","èœ‚å¥³ç‹","å¸•å¥‡åˆ©å…¹","æ³³åœˆé¼¬","æµ®æ½œé¼¬","æ¨±èŠ±å®","æ¨±èŠ±å„¿","æ— å£³æµ·å…”","æµ·å…”å…½","åŒå°¾æ€ªæ‰‹","é£˜é£˜çƒ","éšé£çƒ","å·å·è€³","é•¿è€³å…”","æ¢¦å¦–é­”","ä¹Œé¸¦å¤´å¤´","é­…åŠ›å–µ","ä¸œæ–½å–µ","é“ƒé“›å“","è‡­é¼¬å™—","å¦å…‹è‡­é¼¬","é“œé•œæ€ª","é’é“œé’Ÿ","ç›†æ‰æ€ª","é­”å°¼å°¼","å°ç¦è›‹","è’èƒ–é¸Ÿ","èŠ±å²©æ€ª","åœ†é™†é²¨","å°–ç‰™é™†é²¨","çƒˆå’¬é™†é²¨","å°å¡æ¯”å…½","åˆ©æ¬§è·¯","è·¯å¡åˆ©æ¬§","æ€ªæ²³é©¬","æ²³é©¬å…½","ç´«å¤©è","é¾™ç‹è","ä¸è‰¯è›™","æ¯’éª·è›™","å°–ç‰™ç¬¼","è§å…‰é±¼","éœ“è™¹é±¼","å°æ›¼æ³°å› ","é›ªç¬ æ€ª","æš´é›ªç‹","ç›ç‹ƒæ‹‰","è‡ªçˆ†ç£æ€ª","å¤§èˆŒèˆ”","è¶…ç”²ç‹‚çŠ€","å·¨è”“è—¤","ç”µå‡»é­”å…½","é¸­å˜´ç‚å…½","æ³¢å…‹åŸºæ–¯","è¿œå¤å·¨èœ»","å¶ä¼Šå¸ƒ","å†°ä¼Šå¸ƒ","å¤©èç‹","è±¡ç‰™çŒª","å¤šè¾¹å…½ï¼º","è‰¾è·¯é›·æœµ","å¤§æœåŒ—é¼»","é»‘å¤œé­”çµ","é›ªå¦–å¥³","æ´›æ‰˜å§†","ç”±å…‹å¸Œ","è‰¾å§†åˆ©å¤š","äºšå…‹è¯ºå§†","å¸ç‰™å¢å¡","å¸•è·¯å¥‡äºš","å¸­å¤šè“æ©","é›·å‰å¥‡å¡æ–¯","éª‘æ‹‰å¸çº³","å…‹é›·è‰²åˆ©äºš","éœæ¬§çº³","ç›çº³éœ","è¾¾å…‹è±ä¼Š","æ´å’ª","é˜¿å°”å®™æ–¯"];

        const POKEMON_LIST = ALL_NAMES.map((name, index) => {
            const natId = index + 1;
            return {
                natId: natId,
                name: name,
                johtoId: JOHTO_DEX_MAP[natId] || null
            };
        });

        const STORAGE_KEY = 'hgss_tracker_v10_final';

        function App() {
            const [captured, setCaptured] = useState(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    return saved ? new Set(JSON.parse(saved)) : new Set();
                } catch (e) { return new Set(); }
            });

            const [view, setView] = useState('all'); 
            const [dexMode, setDexMode] = useState('national'); 
            const [search, setSearch] = useState('');

            useEffect(() => {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(captured)));
            }, [captured]);

            const finalFiltered = useMemo(() => {
                let list = [...POKEMON_LIST];
                if (dexMode === 'johto') {
                    list = list.filter(p => p.johtoId !== null).sort((a, b) => a.johtoId - b.johtoId);
                } else {
                    list = list.sort((a, b) => a.natId - b.natId);
                }

                const term = search.toLowerCase();
                return list.filter(p => {
                    const nameMatch = p.name.includes(term);
                    const natIdMatch = String(p.natId).padStart(3, '0').includes(term);
                    const johtoIdMatch = p.johtoId && String(p.johtoId).padStart(3, '0').includes(term);
                    const viewMatch = view === 'all' || captured.has(p.natId);
                    return (nameMatch || natIdMatch || johtoIdMatch) && viewMatch;
                });
            }, [search, view, dexMode, captured]);

            const toggle = (id) => {
                setCaptured(prev => {
                    const next = new Set(prev);
                    if (next.has(id)) next.delete(id);
                    else next.add(id);
                    return next;
                });
            };

            const totalInView = dexMode === 'johto' ? 256 : 493;
            const capturedInView = Array.from(captured).filter(id => {
                if (dexMode === 'national') return id <= 493;
                return JOHTO_DEX_MAP[id] !== undefined;
            }).length;

            const progress = (capturedInView / totalInView) * 100;

            return (
                <div className="flex flex-col min-h-screen">
                    <header className="sticky top-0 z-50 bg-white border-b border-slate-200">
                        <div className="max-w-5xl mx-auto px-4 pb-4">
                            {/* ç¬¬ä¸€è¡Œï¼šæ ‡é¢˜å’Œå›¾é‰´åˆ‡æ¢ */}
                            <div className="flex justify-between items-center py-4">
                                <div className="flex items-center gap-3">
                                    <h1 className="text-xl font-semibold text-red-600 tracking-tighter flex items-center gap-1.5">
                                        <Icon name="pocket" className="w-6 h-6" /> å¿ƒé‡‘é­‚é“¶å›¾é‰´æ ‡è®°
                                    </h1>
                                    <div className="flex p-0.5 bg-slate-200 rounded-lg shrink-0">
                                        <button 
                                            onClick={()=>setDexMode('national')}
                                            className={"px-3 py-1 text-[11px] font-semibold rounded-md transition-all " + (dexMode === 'national' ? 'bg-red-600 text-white shadow-sm' : 'text-slate-500 font-normal')}
                                        >
                                            å…¨å›½
                                        </button>
                                        <button 
                                            onClick={()=>setDexMode('johto')}
                                            className={"px-3 py-1 text-[11px] font-semibold rounded-md transition-all " + (dexMode === 'johto' ? 'bg-red-600 text-white shadow-sm' : 'text-slate-500 font-normal')}
                                        >
                                            åŸéƒ½
                                        </button>
                                    </div>
                                </div>

                                <div className="flex flex-col items-end">
                                    <div className="text-lg font-semibold text-slate-800 font-mono leading-none">
                                        {capturedInView}<span className="text-slate-300 mx-1 text-sm font-normal">/</span>{totalInView}
                                    </div>
                                    <div className="w-20 h-2 bg-slate-100 rounded-full overflow-hidden mt-1.5 border border-slate-100">
                                        <div className="h-full bg-red-500 transition-all duration-700" style={{width: progress + "%"}} />
                                    </div>
                                </div>
                            </div>

                            {/* ç¬¬äºŒè¡Œï¼šæ“ä½œæ  */}
                            <div className="grid grid-cols-12 gap-3 items-center">
                                <div className="relative col-span-7 sm:col-span-8">
                                    <div className="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">
                                        <Icon name="search" className="w-4 h-4" />
                                    </div>
                                    <input 
                                        type="text" 
                                        placeholder="æœç´¢..." 
                                        className="w-full h-11 pl-10 pr-4 bg-slate-100 border-none rounded-xl focus:ring-2 focus:ring-red-500/20 outline-none text-sm font-normal transition-all"
                                        value={search}
                                        onChange={e => setSearch(e.target.value)}
                                    />
                                </div>
                                
                                <div className="tab-segment col-span-5 sm:col-span-4 shadow-sm">
                                    <button 
                                        onClick={()=>setView('all')} 
                                        className={"flex-1 h-full text-base rounded-lg transition-all flex items-center justify-center " + (view === 'all' ? 'bg-white text-red-600 font-semibold shadow-sm' : 'text-slate-500 font-normal')}
                                    >
                                        æ‰€æœ‰
                                    </button>
                                    <button 
                                        onClick={()=>setView('captured')} 
                                        className={"flex-1 h-full text-base rounded-lg transition-all flex items-center justify-center " + (view === 'captured' ? 'bg-white text-red-600 font-semibold shadow-sm' : 'text-slate-500 font-normal')}
                                    >
                                        å·²æ•
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    <div className="flex-1 bg-slate-50 pb-24">
                        <main className="max-w-5xl mx-auto px-4 pt-6">
                            {finalFiltered.length > 0 ? (
                                <div className="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-7 gap-3 sm:gap-4">
                                    {finalFiltered.map(p => {
                                        const isCap = captured.has(p.natId);
                                        const displayId = dexMode === 'johto' ? p.johtoId : p.natId;
                                        const idLabel = String(displayId).padStart(3, '0');
                                        
                                        return (
                                            <button 
                                                key={p.natId} 
                                                onClick={()=>toggle(p.natId)}
                                                className={"pokemon-card relative flex flex-col items-center p-2 rounded-xl border-2 transition-all active:scale-95 " + (isCap ? "bg-white border-red-500 captured-shadow" : "bg-white border-transparent shadow-sm hover:border-slate-300")}
                                            >
                                                {/* å›¾ç‰‡åœ¨ä¸Š */}
                                                <div className="w-full aspect-square flex items-center justify-center relative mb-1.5 pt-1">
                                                    {isCap && <div className="absolute inset-2 bg-red-50 rounded-full blur-xl opacity-40"></div>}
                                                    <img 
                                                        src={`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${p.natId}.png`} 
                                                        className={"pokemon-thumb w-14 h-14 object-contain relative z-10 " + (isCap ? "scale-110 drop-shadow-md" : "uncaptured-img")}
                                                        alt={p.name}
                                                        loading="lazy"
                                                        onerror={(e) => {
                                                            e.target.src = `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${p.natId}.png`;
                                                        }}
                                                    />
                                                </div>

                                                {/* ç¼–å·ä¸åç§°åœ¨ä¸‹ */}
                                                <div className="flex flex-col items-center w-full pb-1">
                                                    <span className={"text-[14px] font-mono font-semibold tracking-tight leading-none " + (isCap ? "text-red-600" : "text-slate-400")}>
                                                        {idLabel}
                                                    </span>
                                                    <span className={"text-[13px] font-semibold truncate w-full text-center mt-1 " + (isCap ? "text-red-600" : "text-slate-700")}>
                                                        {p.name}
                                                    </span>
                                                </div>

                                                {isCap && (
                                                    <div className="absolute top-1.5 right-1.5 bg-red-600 text-white rounded-full p-0.5 ring-2 ring-white shadow-sm z-20">
                                                        <Icon name="check" className="w-2.5 h-2.5" />
                                                    </div>
                                                )}
                                            </button>
                                        );
                                    })}
                                </div>
                            ) : (
                                <div className="py-24 text-center text-slate-300">
                                    <Icon name="ghost" className="w-16 h-16 mx-auto mb-4 opacity-10" />
                                    <p className="text-sm font-semibold tracking-widest uppercase opacity-40 font-normal">æ‰¾ä¸åˆ°å®å¯æ¢¦</p>
                                </div>
                            )}
                        </main>
                    </div>

                    {capturedInView === totalInView && capturedInView > 0 && (
                        <div className="fixed bottom-10 left-1/2 -translate-x-1/2 bg-red-600 text-white px-10 py-4 rounded-full shadow-2xl font-semibold text-sm animate-bounce z-50 border-4 border-white/30">
                            ğŸŒŸ å…¨å›¾é‰´è¾¾æˆ ğŸŒŸ
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>